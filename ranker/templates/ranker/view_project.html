{% extends "base.html" %}
{% load tz %}

{% block content %}
    <p>
        <div>
            <a class="btn btn-primary" href="{% url 'dashboard' %}"
                role="button">Back</a>
            <a class="btn btn-primary" href="{% url 'rate' project.id %}"
                role="button">Live Rating Link</a>
            <a class="btn btn-primary" href="{% url 'export_rankings' project.id %}"
                role="button">Export Estimates</a>
            <a class="btn btn-primary" href="{% url 'export_ratings' project.id %}"
                role="button">Export Ratings</a>
        </div> 
    </p>

    <h3>Project Overview</h3>
    <table class="table table-striped table-bordered bottom-table">
        <tbody>
            <tr><td>Project Name</td><td>{{ project.name }}</td></tr>
            <tr><td>Prompt</td><td>{{ project.prompt }}</td></tr>
            <tr><td># of ratings collected</td><td>{{ project.ratings.all | length }}</td></tr>
        </tbody>
    </table>

    <h3>Item Estimates</h3>
    <table class="table table-striped table-bordered bottom-table">
        <thead>
            <tr>
                <th class="text-center">Items</th>
                <th class="text-center">Images</th>
                <th class="text-center">Parameter Distribution</th>
                <th class="text-center">Parameter Estimate with 95% Confidence
                    Interval</th>
            </tr>
        </thead>
        <tbody>
            {% for item in project.items.all %}
            <tr>
                <td style="vertical-align: middle"> {{ item.name }} </a></td>
            <td style="vertical-align: middle" class="text-center">
                <img style="width:100px;" src="{{ item.image.url }}"/>
            </td>
            <td style="vertical-align: middle; padding-top:30px; margin:0px;">
                <div class="progress">
                    <div class="progress-bar progress-bar-warning"
                        style="width: {{ item.lower_percent }}%">
                        <span class="sr-only"></span>
                    </div>
                    <div class="progress-bar progress-bar-success" style="width: {{ item.percent }}%">
                        <span class="sr-only"></span>
                    </div>
                    <div class="progress-bar progress-bar-warning" style="width: {{ item.upper_percent }}%">
                        <span class="sr-only"></span>
                    </div>
                </div>
            </td>
            <td style="vertical-align: middle"> {{ item.mean|floatformat:"3" }}
                +/- {{ item.conf|floatformat:"3" }} {{ item.lower_value }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h3>Judge Discrimination Estimates</h3>
    <table class="table table-striped table-bordered bottom-table">
        <thead>
            <tr>
                <th class="text-center">Judge ID</th>
                <th class="text-center">Discrimination</th>
            </tr>
        </thead>
        <tbody>
            {% for judge in judges %}
            <tr>
                <td style="vertical-align: middle"> {{ judge.id }} </a></td>
                <td style="vertical-align: middle">{{ judge.discrimination|floatformat:"3" }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}

